---
format:
  html:
    toc: true
    toc-title: "Contenidos"
    toc-expand: 1
    code-overflow: wrap
editor_options:
  markdown:
    wrap: sentence
    canonical: true
theme: cosmo
---
# Introducci√≥n a R {#sec-intro}

```{r}
#| include: false
source("_common.R")
```

## Instalando <i class="fab fa-r-project"></i> y R Studio

R Studio es un entorno de desarrollo integrado (IDE por sus siglas en ingl√©s), con varias herramientas que permiten utilizar los lenguajes de programaci√≥n *R* y *python*, ambas utilizadas ampliamente en la ciencia de datos.
Este software provee una interfaz intuitiva que permite un manejo f√°cil y amigable de cualquier tipo de datos.
Tanto R como R Studio son de c√≥digo abierto y pueden descargarse gratuitamente.

Actualmente, existen dos alternativas para utilizar R Studio.
Este puede instalarse localmente en un computador, o puedes utilizarlo en la web a trav√©s de [Posit Cloud](https://posit.cloud/).
Esta √∫ltima opci√≥n es muy √∫til si tu computador no cuenta con suficiente memoria RAM.
Crear una cuenta en Posit cloud es gratis y puedes crear hasta **25 proyectos**.
Para hacerlo solamente sigue [este enlace](https://posit.cloud/plans/free), haz clic en *Sign up*, y sigue las instrucciones.

Una vez hayas creado tu cuenta, ver√°s una ventana como la siguiente y puedes crear un nuevo proyecto:

![](docs/Figures/posit_cloud_start.png)

Por el contrario, si quieres tener R y R Studio en tu computador debes contar con acceso a internet y cualquier navegador web de tu preferencia, Chrome, Firefox, etc.
Si tu Sistema Operativo es Windows la descarga de R debe hacerse desde el subdirectorio base en la web de CRAN (Comprehensive R Archive Network), [aqu√≠](https://cran.r-project.org/bin/windows/base/).
De la misma manera, R Studio para Windows puede ser descargado desde [aqu√≠](https://posit.co/download/rstudio-desktop/).
Si surge alg√∫n problema durante la instalaci√≥n o quieres saber m√°s sobre R, puedes dirigirte a la secci√≥n de [Preguntas frecuentes de R](https://cran.r-project.org/doc/FAQ/R-FAQ.html).

Si tienes otro Sistema Operativo o tienes un nivel medio o avanzado en el uso de R, te recomiendo leer este [tutorial de instalaci√≥n](https://rubenfcasal.github.io/post/instalacion-de-r/#windows).

## !Ya has instalado R Studio! ¬øY ahora qu√©?

Una vez que abras R Studio notar√°s muchas opciones, paneles y una consola que puede parecer confusa al principio pero ahora te familiarizar√°s r√°pidamente con esta interfaz.

La barra de herramientas en la parte superior contiene las opciones File, Edit, Code, View, etc.
Debajo de **File** puedes encontrar un icono similar a este {{< fa file-circle-plus >}}.
Una vez hagas clic en este, podr√°s ver una amplia lista de documentos que puedes crear, entre ellos **R Script**.
Este es el tipo de documento que utilizaremos para escribir nuestros c√≥digos.

::: callout-note
Tambi√©n puedes crear un nuevo script presionando **`Ctrl+Shift+N`**.
:::

![](docs/Figures/script1.png){.column-page-right .border fig-alt="Interfaz R" fig-align="center"}

Una vez que hayas creado un nuevo script, R Studio lucir√° de la siguiente manera:

![](Figures/R_script2.png){.column-page-right .border fig-alt="Crear nuevo script" fig-align="center"}

Ahora puedes observar 4 paneles con varias opciones dentro de cada uno.

-   **Source** es el panel en el que manipularemos y almacenaremos nuestros c√≥digos como **Scripts**.
-   **Environment** almacena los objetos que son creados a lo largo de nuestro trabajo.
-   El panel que contiene a las pesta√±as Files, Plots, Packages, Help y Viewer, nos permite encontrar de manera r√°pida y eficiente los archivos en nuestro directorio de trabajo (**Files**), los gr√°ficos generados a partir de an√°lisis (**Plots**), los paquetes instalados (**Packages**), manuales de ayuda de R y de paquetes instalados (**Help**), y por √∫ltimo encontramos a **Viewer**, un panel que nos muestra gr√°ficos interactivos generados por algunos paquetes.
-   En **Console** encontrar√°s el signo ‚Äú\>‚Äù llamado prompt que nos muestra si el sistema est√° listo o no para ejecutar un comando. Adem√°s, los resultados de los an√°lisis se mostrar√°n aqu√≠.

## ¬øQu√© es un script?

Un script es una serie de comandos escritos en un archivo de texto que pueden ser almacenados, editados y ejecutados.
¬øSuena sencillo?
Efectivamente es un concepto simple y tiene muchas ventajas si se lo compara con programas que no cuentan con esta opci√≥n.
Un script nos brinda la posibilidad de editar cualquier l√≠nea de comando las veces que sea necesario, te permite retomar cualquier trabajo tras varios d√≠as, meses o a√±os.
Adem√°s puedes agregar comentarios sobre el c√≥digo que escribes como veremos a continuaci√≥n.
Esto resulta extremanente √∫til si quieres compartir tu trabajo con otros, o si te encuentras trabajando en un proyecto extenso, el cual podr√°s retomar exactamente desde donde lo dejaste.

Ahora que conoces un poco m√°s sobre esta interfaz, ¬°ya puedes empezar!

## Primeros pasos

Empecemos escribiendo operaciones matem√°ticas sencillas en el script.

```{r eval=FALSE}
2 + 2
```

Ahora presiona Enter, ¬øqu√© sucede?
Es importante saber que la ejecuci√≥n de comandos con la tecla **Enter** se lleva a cabo solamente en la **Consola**.
Si quieres ejecutar un c√≥digo dentro del script, debes apretar **Ctrl+Enter**.

Ahora escribe la misma operaci√≥n precedida por un signo numeral `#` y presiona **Ctrl+Enter**.

```{r eval=FALSE}
# 2 + 2
```

¬øHay alg√∫n resultado?
Si colocamos este s√≠mbolo al iniciar una l√≠nea, esta no ser√° le√≠da como un c√≥digo por R, por lo que no se ejecutar√°.
Esto es muy √∫til al momento de agregar comentarios sobre el c√≥digo que escribimos y para poder compartirlo con otros y as√≠ entiendan r√°pidamente que realizaste en tu trabajo.

Sigamos intentando con m√°s operaciones matem√°ticas.

```{r eval= FALSE}
# Divisi√≥n
8/2

# Multiplicaci√≥n y suma
2*2+7
2*(2+7) #¬øEste resultado es diferente?

# Potenciaci√≥n
3^3

# Potencia negativa
3^-3

# Tambi√©n puedes ejecutar varias operaciones sobre una misma l√≠nea
3*10 ; 15/45 ; 15-37
```

Compliquemos esto aplicando otras funciones matem√°ticas.

```{r eval= FALSE}
# Logaritmo
log(5)

# Logaritmo natural y base 10 con otras operaciones
log(5)/log2 (5*3)

# Raiz cuadrada
sqrt(23.567)

# Factorial
factorial (24)
```

Nota que los n√∫meros ahora se encuentran dentro de un par√©ntesis y delante de una **funci√≥n**.
Existen probablemente millones de funciones en R con prop√≥sitos diferentes y espec√≠ficos.
Para poder ejecutarlas, √©stas deben estar escritas con la estructura que viste en el ejemplo anterior `funci√≥n( ... )`.
T√∫ tambi√©n puedes crear tus propias funciones, pero eso lo dejaremos para un curso m√°s avanzado.

Todos los resultados de estas operaciones se muestran en la **Consola**.
Sin embargo, si quisieras almacenarlos y manipularlos es necesario transformarlos en **objetos**.
Para ello debemos hablar sobre la estructura de datos.

## Estructura de datos

R contiene una jerarqu√≠a de elementos y provee varios tipos de estructuras de datos especializadas a las que se les conoce como objetos.
Para los prop√≥sitos de este curso mencionaremos a los vectores y matrices pero nos enfocaremos en los *data frames*.
Sin embargo, es importante saber que existen otros tipos de estructuras de datos como las listas, que utilizaremos ampliamente en el nivel avanzado de este curso.

### Vectores

Un vector es una secuencia de datos del mismo tipo ya sean **num√©ricos** o de **car√°cter**.
As√≠, para construir vectores num√©ricos, deberemos primeramente nombrar a nuestro objeto y asignarle valores mediante `<-`.
Supongamos que quieres almacenar los resultados de las operaciones anteriores en un objeto "x" e "y".

```{r eval= FALSE}
x <- log(5)

y <- log(5)/log2(5*3)
```

Observa que en el panel **Environment** ahora hay dos objetos que corresponden a los vectores num√©ricos que creaste con los resultados de cada operaci√≥n.
De esta manera, ahora ser√° m√°s f√°cil manipular estos datos.

```{r eval= FALSE}
# Ejecuta lo siguiente
x*y

# Almacena el resultado de ambos objetos en un vector nuevo
z <- x*y

# Puedes imprimir el resultado en la consola
z
```

Ahora crea una secuencia de n√∫meros dentro de un vector.
Una forma r√°pida de crear este tipo de vectores es mediante la funci√≥n `seq`.

```{r eval= FALSE}
# Puedes crear n√∫meros sucesivos del 1 - 10
a <- c(1:10)

# O una secuencia hasta el 15 con un intervalo de 3
b <- seq(1, 15, 3)
```

La funci√≥n `seq` crea secuencias en este caso del n√∫mero 1 hasta el 15, con un intervalo de 3.
Pero, ¬øc√≥mo podr√≠as saber qu√© significa cada argumento dentro de una funci√≥n si no la conoces?

Existen dos maneras de indagar sobre una funci√≥n cualquiera y obtener ayuda sobre la misma:

```{r eval= FALSE}
?seq
help(seq)
```

La secci√≥n de ayuda contiene todo lo que debes saber sobre cualquier funci√≥n, al final de cada manual de instrucciones de la funci√≥n podr√°s ver adem√°s ejemplos que te ayudar√°n a entenderla y aplicarla seg√∫n tus necesidades.

Ahora bien, puedes aplicar esto a un ejemplo m√°s cotidiano.
Imagina que posees datos de distintos pesos de varios individuos de una especie de roedor que has capturado y quieres realizar algunas operaciones con ellos.
Almacena estos pesos dentro de un vector utilizando la funci√≥n concatenar `c()`.

```{r eval= FALSE}
pesos <- c(25, 27, 30, 20, 26, 27.5, 23, 30.8)
```

Ahora que tienes estos datos almacenados en un vector, puedes realizar operaciones con ellos.

```{r eval= FALSE}
# N√∫mero de observaciones
length(pesos)

# Valores minimos y maximos
min(pesos)
max(pesos)

# Promedio
mean(pesos)
```

Para hacer este ejemplo a√∫n m√°s real, imagina que las medidas tomadas eran err√≥neas o ya no sirven para su estudio.
Puedes entonces modificar el vector de la siguiente manera:

```{r eval= FALSE}
# Elimina el cuarto valor en nuestro vector
pesos_mod <- pesos[-4]

# Remueve desde el primer hasta el quinto valor
pesos_mod <- pesos[-1:-5]

# Agrega m√°s valores al vector
pesos_mod <- c(pesos, 21, 28.3, 31, 26.5)
```

Cuando modificas un vector es usualmente aconsejable crear uno nuevo y almacenar la nueva informaci√≥n en √©ste.
El c√≥digo no siempre se ver√° tan sencillo como en el ejemplo anterior y es mejor trabajar de una manera segura al manipular metadatos.

Es muy √∫til saber que si deseas eliminar cualquier objeto, lo puedes hacer en cualquier momento mediante la funci√≥n `remove()` o `rm()`.
Esto es especialmente √∫til si est√°s trabajando con un set de datos muy grande y quieres liberar memoria.

### Matrices

Una matriz no es m√°s que un conjunto de datos del mismo tipo organizado de forma bidimensional, es decir, en filas y columnas.
Crear y modificar matrices tiene tambi√©n un proceso parecido al de los vectores.

```{r eval=FALSE}
matriz <- matrix(1:14, ncol=7)
matriz
```

::: callout-tip
## Ejercicio

Organiza diferentes matrices con diferentes n√∫meros de columnas y filas, usa `help(matrix)` para saber como hacerlo.
¬øQu√© sucede si organizas la matriz mediante `matrix(2:14, ncol=3)`?:
:::

Este m√©todo solo crea matrices con datos secuenciales, entonces ¬øc√≥mo podr√≠as organizar distintos pesos de roedores de forma bidimensional?
Siguiendo con el ejemplo de los roedores, supongamos que tienes dos especies de roedores.

```{r}
roedor1 <- c(25, 27, 30, 20, 26, 27.5, 23, 30.8)
roedor2 <- c(26, 26.5, 30, 20, 31, 27.5, 28, 20.8)

# Lee sobre cbind usando help()
roedores <- cbind(roedor1, roedor2)

# Ahora utiliza rbind() para unir ambos vectores. ¬øCu√°l es la diferencia?
```

Al igual que los vectores, las matrices tambi√©n pueden ser modificadas.
Sin embargo, al haber a√±adido una dimensi√≥n m√°s a nuestros datos, la forma de escribir los c√≥digos cambia dependiendo de si quieres modificar una fila o una columna.

```{r}
# Elimina la cuarta fila
roedores_mod <- roedores[-4,]

# Elimina la 1ra, 2da y 7ma fila
roedores_mod <- roedores[c(-1,-2,-7),]

# Ahora intenta esto
roedores_mod <- roedores[,-1]
# ¬øQu√© pas√≥ luego de ejecutar este c√≥digo?
# Observa la posici√≥n de la coma
```

::: callout-tip
## Ejercicio

A√±ade dos nuevas columnas a la matriz roedores y posteriormente elimina los datos desde la 2<sup>da</sup> hasta la 4<sup>ta</sup> fila.
:::

Tambi√©n puedes usar distintas funciones para analizar cualquier matriz.

```{r eval= FALSE}
head(roedores)
nrow(roedores)
class(roedores)
```

Puedes leer mas sobre estas funciones en la secci√≥n de ayuda.

### *Data frames*

Un *data frame* es un set de datos que puede estar conformado tanto por valores num√©ricos o tambi√©n por caracteres.
Trabajar con este tipo de objetos es una aproximaci√≥n m√°s realista debido al tipo de .

Continuemos con nuestro ejemplo de los roedores, supongamos que quieres agregar una columna que contenga un vector de caracteres y se le asigne el nombre de especie a cada roedor.
Para este prop√≥sito organizaremos los datos de pesos de los roedores en filas.

```{r}
# A√±ade varias veces los objetos creados anteriormente
roedores <- cbind(roedor1, roedor2, roedor1, roedor2)
class(roedores)

#Crea un vector de caracteres
localidad <- c("Quito", "Guayaquil")
```

El objeto roedores es a√∫n una matriz, ¬øc√≥mo podr√≠as a√±adir las localidades para convertirlo en un *data frame*?

```{r results='hide'}
# Utiliza la funci√≥n data.frame
roedores <- data.frame(roedores, localidad)

# Analiza el data frame
class(roedores)
summary(roedores)
str(roedores)
```

La funci√≥n `summary` y `str` nos brindan informaci√≥n relevantes que ser√° necesaria en clases posteriores.
¬øQu√© pasa si quieres saber algo m√°s espec√≠fico como cu√°ntos valores por debajo de 25 existen en el *data frame*?

```{r echo=TRUE}
roedores <= 25
```

Ejecutar este c√≥digo nos devuelve valores l√≥gicos o tambi√©n llamados *booleanos* como resultado.
Cada `TRUE` o `FALSE` puede ser contado individualmente, pero ¬øc√≥mo lograr√≠as contarlos autom√°ticamente?

```{r eval=FALSE}
sum(roedores<= 25)
#Ahora utiliza la funci√≥n which(), ¬øcu√°l es la diferencia?
```

Tambi√©n puedes elegir columnas individuales y realizar el mismo procedimiento.
El signo `$` se√±ala cual es la columna de la cual quieres tomar los datos.

```{r eval=FALSE}
roedores$roedor1 > 25
```

La manipulaci√≥n de esta clase de objetos ser√° ampliada y tratada con m√°s detenimiento en la siguiente clase.

### Listas

xxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx

# Paquetes

El hecho de que R sea un software de c√≥digo abierto permite que cualquier persona puede crear sus propias l√≠neas de c√≥digo y funciones para resolver determinados problemas o automatizar procesos.

Existen un gran n√∫mero de paquetes que pueden ser descargados gratuitamente desde el repositorio central de paquetes de R, **CRAN**. Sin embargo, CRAN no es el √∫nico repositorio que existe y aunque en este curso este es el √∫nico que ocuparemos, es necesario nombrar a **Bioconductor** y **Github** como otros de los m√°s usados.
Cada uno cuenta con su manera de descarga e instalaci√≥n de paquetes.

Volviendo a CRAN, para descargar un paquete solamente necesitamos ejecutar el comando `install.packages("nombre_del_paquete")`.
El nombre del paquete debe ser reemplazado dentro de los par√©ntesis y entre comillas, de la siguiente manera:

```{r eval=FALSE}
#Instala el paquete dplyr
install.packages("dplyr")
```

Una vez descargado, este ya se encuentra almacenado en tu computadora, en la direcci√≥n que indica la consola. Ahora, para poder usarlo solamente debes activarlo mediante:

```{r eval=FALSE}
library(dplyr)
```

Los paquetes tambi√©n cuentan con una secci√≥n de ayuda, a la cual puedes acceder mediante este c√≥digo:

```{r eval=FALSE}
help (package= "dplyr")
```

Ahora que ya sabes descargar paquetes, descarga `ggplot2`, el cual ser√° necesario para visualizar datos en la siguiente secci√≥n.

## *tidyverse*

*Tidyverse* es una colecci√≥n de paquetes que contiene a dplyr y ggplot2.
Estos han sido creados para facilitar la manipulaci√≥n y vsualizaci√≥n de datos mediante gr√°ficos est√©ticos con varias opciones para modificarlos y presentarlos.
Puedes ver algunos ejemplos en la [galer√≠a oficial](https://r-graph-gallery.com/) de *ggplot2*, y varios ejemplos sobre las [extensiones](https://exts.ggplot2.tidyverse.org/gallery/) que han sido escritas para ampliar a√∫n m√°s el funcionamiento de este paquete.

Una vez hayas activado dplyr, ya puedes buscat datos espec√≠ficos en el *data frame* ‚Äúroedores‚Äù.

```{r eval=FALSE}
library(dplyr)

# Filtra por localidad
filter(roedores, localidad == "Quito")

# Almacena los resultados en un objeto nuevo llamado capital
capital <- filter(roedores, localidad == "Quito")
capital <- select(capital, roedor2)
```

üìö **Tarea**

Utiliza todo lo aprendido en esta clase y el set de datos `roedores` y responde: ¬øcu√°ntos individuos de Guayaquil tienen pesos menores o iguales a 26.5?

## *ggplot2*

Ahora puedes visualizar los datos de una manera m√°s atractiva y comprensible.
Para ello, activa el paquete *ggplot2* y ejecuta:

```{r}
ggplot(data = roedores) +
  geom_point(aes(x = roedor1, y = roedor2),
             size = 5)
```

üìö **Tarea**

Utiliza el manual de ayuda de `geom_point()` para descifrar como elabor√© este gr√°fico:

```{r echo=FALSE}
ggplot(data = roedores) +
  geom_point (aes(x = roedor1, y = roedor2, color = localidad),
              size = 5)
```

# Nota

Como en cualquier actividad o disciplina, el manejo de R requiere constancia, disciplina y paciencia.
Ten en cuenta que los ejemplos de este curso est√°n planeados para que funcionen al primer intento, sin embargo, esto jam√°s va a ser la normal cuando analices tu propio set de datos debdo a m√∫ltiples factores.
Ten en cuenta que muchas veces las respuestas a los inconvenientes que encuentres podr√°s resolverlos en varios sitios web, e incluso con la ayuda Inteligencia Artificial (IA).

Si eres nuevo en el mundo de la programaci√≥n, no recomiendo que utilices IA para resolver tus problemas, ya que el autoaprendizaje y la prueba y error son sumamente importantes cuando se empieza a conocer un lenguaje de programaci√≥n.

# Fuentes

El presente trabajo ha sido escrito y editado por [Francisco Castellanos](https://orcid.org/0000-0003-0955-8185) y est√° influenciado por la clase "Introducci√≥n B√°sica al Lenguaje de R" de [Juan Pablo Zurano](https://www.researchgate.net/profile/Juan-Zurano-3), as√≠ como tambi√©n: [YaRrr](https://bookdown.org/ndphillips/YaRrr/writing-r-scripts-in-an-editor.html), [The R Book](https://www.cs.upc.edu/~robert/teaching/estadistica/TheRBook.pdf), y [R for Data Science](https://r4ds.hadley.nz/).
<br> <br>

------------------------------------------------------------------------

::: {.callout appearance="simple"}
<small style="font-size: 80%;">¬© 2024 Fundaci√≥n Oso Andino.
Todos los derechos reservados.</small>
:::